<!DOCTYPE html>
<html lang="en-US">

<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
  <meta http-equiv="X-Clacks-Overhead" content="GNU Terry Pratchett" />
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
<link rel="shortcut icon" href="http://localhost:1313/images/favicon.png" />
<title>2024 Year of the Supply Chain Attack | Gene Wahrlich</title>
<meta name="title" content="2024 Year of the Supply Chain Attack" />
<meta name="description" content="Exploding pagers
The news of Hezbollah agents being targeted with exploding pagers and UHF radios was a shock to us all. Whilst this type of attack was always a possibility in theory, seeing it occur in practice was perhaps the most visually horrific instance of a supply chain attack in recent history. This attack, along with the .mobi WHOIS debacle and the faulty Crowdstrike update, got me thinking quite a lot about supply chain attack surface. We all have these vulnerabilities, and there&rsquo;s very little we can do in the way of mitigation." />
<meta name="keywords" content="supply chain," />


<meta property="og:url" content="http://localhost:1313/post/2024-year-of-the-supply-chain-attack/">
  <meta property="og:site_name" content="Gene Wahrlich">
  <meta property="og:title" content="2024 Year of the Supply Chain Attack">
  <meta property="og:description" content="Exploding pagers The news of Hezbollah agents being targeted with exploding pagers and UHF radios was a shock to us all. Whilst this type of attack was always a possibility in theory, seeing it occur in practice was perhaps the most visually horrific instance of a supply chain attack in recent history. This attack, along with the .mobi WHOIS debacle and the faulty Crowdstrike update, got me thinking quite a lot about supply chain attack surface. We all have these vulnerabilities, and there’s very little we can do in the way of mitigation.">
  <meta property="og:locale" content="en_US">
  <meta property="og:type" content="article">
    <meta property="article:section" content="post">
    <meta property="article:published_time" content="2024-09-23T14:19:48+10:00">
    <meta property="article:modified_time" content="2024-09-23T14:19:48+10:00">
    <meta property="article:tag" content="Supply Chain">
    <meta property="og:image" content="http://localhost:1313/images/share.png">




  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:image" content="http://localhost:1313/images/share.png">
  <meta name="twitter:title" content="2024 Year of the Supply Chain Attack">
  <meta name="twitter:description" content="Exploding pagers The news of Hezbollah agents being targeted with exploding pagers and UHF radios was a shock to us all. Whilst this type of attack was always a possibility in theory, seeing it occur in practice was perhaps the most visually horrific instance of a supply chain attack in recent history. This attack, along with the .mobi WHOIS debacle and the faulty Crowdstrike update, got me thinking quite a lot about supply chain attack surface. We all have these vulnerabilities, and there’s very little we can do in the way of mitigation.">




  <meta itemprop="name" content="2024 Year of the Supply Chain Attack">
  <meta itemprop="description" content="Exploding pagers The news of Hezbollah agents being targeted with exploding pagers and UHF radios was a shock to us all. Whilst this type of attack was always a possibility in theory, seeing it occur in practice was perhaps the most visually horrific instance of a supply chain attack in recent history. This attack, along with the .mobi WHOIS debacle and the faulty Crowdstrike update, got me thinking quite a lot about supply chain attack surface. We all have these vulnerabilities, and there’s very little we can do in the way of mitigation.">
  <meta itemprop="datePublished" content="2024-09-23T14:19:48+10:00">
  <meta itemprop="dateModified" content="2024-09-23T14:19:48+10:00">
  <meta itemprop="wordCount" content="1898">
  <meta itemprop="image" content="http://localhost:1313/images/share.png">
  <meta itemprop="keywords" content="Supply Chain">
<meta name="referrer" content="no-referrer-when-downgrade" />

  <style>
  body {
    font-family: Verdana, sans-serif;
    margin: auto;
    padding: 20px;
    max-width: 720px;
    text-align: left;
    background-color: #fff;
    word-wrap: break-word;
    overflow-wrap: break-word;
    line-height: 1.5;
    color: #444;
  }

  h1,
  h2,
  h3,
  h4,
  h5,
  h6,
  strong,
  b {
    color: #222;
  }

  a {
    color: #3273dc;
     
  }

  .title {
    text-decoration: none;
    border: 0;
  }

  .title span {
    font-weight: 400;
  }

  nav a {
    margin-right: 10px;
  }

  textarea {
    width: 100%;
    font-size: 16px;
  }

  input {
    font-size: 16px;
  }

  content {
    line-height: 1.6;
  }

  table {
    width: 100%;
  }

  img {
    max-width: 100%;
  }

  code {
    padding: 2px 5px;
    background-color: #f2f2f2;
  }

  pre code {
    color: #222;
    display: block;
    padding: 20px;
    white-space: pre-wrap;
    font-size: 14px;
    overflow-x: auto;
  }

  div.highlight pre {
    background-color: initial;
    color: initial;
  }

  div.highlight code {
    background-color: unset;
    color: unset;
  }

  blockquote {
    border-left: 1px solid #999;
    color: #222;
    padding-left: 20px;
    font-style: italic;
  }

  footer {
    padding: 25px;
    text-align: center;
  }

  .helptext {
    color: #777;
    font-size: small;
  }

  .errorlist {
    color: #eba613;
    font-size: small;
  }

   
  ul.blog-posts {
    list-style-type: none;
    padding: unset;
  }

  ul.blog-posts li {
    display: flex;
  }

  ul.blog-posts li span {
    flex: 0 0 130px;
  }

  ul.blog-posts li a:visited {
    color: #8b6fcb;
  }

  @media (prefers-color-scheme: dark) {
    body {
      background-color: #333;
      color: #ddd;
    }

    h1,
    h2,
    h3,
    h4,
    h5,
    h6,
    strong,
    b {
      color: #eee;
    }

    a {
      color: #8cc2dd;
    }

    code {
      background-color: #777;
    }

    pre code {
      color: #ddd;
    }

    blockquote {
      color: #ccc;
    }

    textarea,
    input {
      background-color: #252525;
      color: #ddd;
    }

    .helptext {
      color: #aaa;
    }
  }

</style>

</head>

<body>
  <header><a href="/" class="title">
  <h2>Gene Wahrlich</h2>
</a>
<nav><a href="/">Home</a>

<a href="/post">Posts</a>


<a href="/about/">About</a>


</nav></header>
  <main>

<content>
  <h1 id="exploding-pagers">Exploding pagers</h1>
<p>The news of Hezbollah agents being targeted with exploding pagers and UHF radios was a shock to us all. Whilst this type of attack was always a possibility in theory, seeing it occur in practice was perhaps the most visually horrific instance of a supply chain attack in recent history. This attack, along with the .mobi WHOIS debacle and the faulty Crowdstrike update, got me thinking quite a lot about supply chain attack surface. We all have these vulnerabilities, and there&rsquo;s very little we can do in the way of mitigation.</p>
<h1 id="its-a-matter-of-trust">Its a matter of trust</h1>
<p>A supply chain attack is one where a target organisation or individual&rsquo;s external suppliers are compromised with the intention to attack the target. Suppliers can come in many forms. For Hezbollah, it was the hardware manufacturers, but it could also be software dependencies, saas apps, internet infrastructure, service suppliers, or any other entity with a privileged connection to you or your business.</p>
<p>You trust suppliers of all forms to provide a product or service free from vulnerabilities. In some cases there are contracts to set limits on damages - I know I had to buy some hefty insurance before pentesting HFT firms in the past. In other cases there is no contract - trust is given for no apparent reason. Why would you have any reason to doubt the company supplying your office desks?</p>
<p>The risk of supply chain attacks should be included in any threat model where relevant. For most of us, although the likelihood of exploding devices is approaching zero, the impact is so high that we should perhaps pay more attention to the mundane suppliers. Those are the ones that will be the easiest for adversaries to compromise and remain unnoticed.</p>
<h1 id="six-attack-vectors-in-supply-chains">Six attack vectors in supply chains</h1>
<h2 id="1-compromised-internet-infrastructure">1. Compromised internet infrastructure</h2>
<p>One of the most mundane of all suppliers is the system of domain name registries, registrars, WHOIS, DNS, and other creaking tech that underpin all goings on on the internet. As a co-founder of an early domain name registrar I know first hand that some of the regisitration and update processes had very little in the way of authentication and authorisation. Some of this tech we still rely on today - WHOIS for example.</p>
<p>WatchTowr <a href="https://labs.watchtowr.com/we-spent-20-to-achieve-rce-and-accidentally-became-the-admins-of-mobi/">recently found</a> that they could register an outdated domain used by the .mobi registry to take over the TLD. When the .mobi TLD became available, the registry switched their WHOIS server from whois.dotmobiregistry.net to whois.mic.mobi. Their error was allowing their .net domain to lapse, which makes it registerable again by anyone - in this case, WatchTowr researchers. They found that many companies - including TLS Certificate Authorities (CAs) - relied on WHOIS data as an authoritative source.</p>
<p>The .mobi registry has learnt a hard lesson - don&rsquo;t let important domain names lapse - ever. But really the victims of this attack are far removed from the regsitry. The victim is not the registry, or the CAs, or the businesses who relied on those CAs. The victims are the users of those encrypted websites, ordinary people like you and me.</p>
<p>How could we as users have mitigated the risk of this attack? Honestly there&rsquo;s not much we can do. Its a matter of trust.</p>
<h2 id="2-compromised-saas-app">2. Compromised saas app</h2>
<p>We all use so many saas apps in business that reliance on them has become a serious security concern. There are risks around data ownership, identity and access management, regulatory issues, vendor security standards, data loss, shadow IT, and incident response complexity. Using saas apps effectively widens your trust boundary to include those companys as well as your own.</p>
<p>This greatly increases attack surface for your business, whilst making security controls more difficult to deploy. One of my favourite preventative controls is pentesting and red teaming, but both of these can be very difficult to perform when saas apps are involved because of legal issues testing components that don&rsquo;t belong to your business.</p>
<p>A recent example of a vulnerable saas app that affected many users is the <a href="https://www.kiteworks.com/cybersecurity-risk-management/dropbox-sign-breach">2024 DropBox Sign</a> issue. A malicious actor gained access to a DropBox configuration tool, and was able to exfiltrate emails and usernames, phone numbers, hashed passwords, and authentication information such as OAuth tokens and MFA data.</p>
<p>There are few mitigations against vulnerable saas apps. You could send out one of those third-party security questionnaires asking about which standards they comply with, what are their SSDLC practices and so on, but really those are quite pointless. I&rsquo;ve seen too many vendors tell pork pies about their security practices in order to win business. The concensus, unfortunately, is that a saas app is secure &ldquo;because everyone else is using it!&rdquo;.</p>
<p>You could perhaps check if the saas app is signed up to a bug bounty program. At least that is verifiable publicly.</p>
<h2 id="3-compromised-hardware-supplier">3. Compromised hardware supplier</h2>
<p>This is the hot one right now due to <a href="https://www.bbc.com/news/articles/ce9jglrnmkvo">what&rsquo;s going on in Lebanon</a>. There are however precedents for this type of attack, although not quite as spectacular. In 2022 it was revealed that Supermicro motherboards contained a rice-grain sized extra chip embedded in them, which connected out to China periodically for unknown reasons&hellip; AWS and Apple have denied that any of the compromised hardware ever made it in to their cloud infrastructure.</p>
<p>The five-eyes governments of <a href="https://www.bbc.com/news/world-us-canada-63764450">USA</a>, <a href="https://www.bbc.com/news/business-55124236">UK</a>, <a href="https://www.bbc.com/news/business-61517729">Canada</a>, <a href="https://www.smh.com.au/national/huawei-no-way-why-australia-banned-the-world-s-biggest-telecoms-firm-20210503-p57oc9.html">Australia</a> and <a href="https://www.theguardian.com/business/2018/nov/28/new-zealand-blocks-huawei-5g-equipment-on-security-concerns">New Zealand</a> have all banned Huawei devices from their critical national networks, for fear of the overbearing control the Chinese Communist Party (CCP) have over private companies in China.</p>
<p>This type of attack would require the manufacturer to be in cahoots with the attacker. A lesser but still effective entry point for an attacker would be to intercept shipment of devices and plant the dodgy hardware in the devices then. I expect this was the attack vector in Lebanon, though I would also expect the attack to be easily identified if one of the devices was opened up. You can&rsquo;t hide explosives as well as hardware measured in nanometres.</p>
<p>Hardware supply chain attacks are partially the reason why governments procure Evaluated Products for their SECRET and TOP SECRET projects. Devices that have passed the <a href="https://commoncriteriaportal.org/products/index.cfm">Common Criteria</a> have a higher level of assurance than uncertified devices. So if you&rsquo;re a government, that&rsquo;s your mitigation, although it sometimes takes so long for a device to be Evaluated that it&rsquo;s hard to find bleeding edge tech in the list.</p>
<p>Owing to the level of sophistication of this attack, the most likely targets are nation states, cloud suppliers and critical national infrastructure. If you did suspect some C4 in your mobile phone, I expect kevlar phone cases to become available shortly. The rest of us can probably keep this marked down as an accepted risk.</p>
<h2 id="4-compromised-software-supplier">4. Compromised software supplier</h2>
<p>There are two stand-out examples of a software supply chain issues recently.</p>
<p>First, In July 2024, a faulty update from Endpoint Detection and Response (EDR) tool maker Crowdstrike caused many high profile <a href="https://www.nytimes.com/2024/07/19/business/microsoft-outage-cause-azure-crowdstrike.html">outages across the world</a>. Since this tool is deployed extensively by governments and high-security organisations, the impact was considerable. Personally, I couldn&rsquo;t use my bank card or use the checkouts at my local grocery store for a few hours due to outages.</p>
<p>Although this denial of service was unintentional, it&rsquo;s still a risk and should be included in threat models. The outage didn&rsquo;t affect me much - I just waited a couple hours to get my bread and milk. But some companies are seeking significant compensation, due to thing like trading systems and critical healthcare systems going down.</p>
<p>Second, the <a href="https://cloud.google.com/blog/topics/threat-intelligence/evasive-attacker-leverages-solarwinds-supply-chain-compromises-with-sunburst-backdoor">SolarWinds attack in 2020</a>. SolarWinds is a very popular IT management tool that helps administer IT equipment in your company&rsquo;s network. This was a bonafide attack - pinned on the Russian group Cozy Bear - who compromised SolarWinds build system to inject malware into software updates. In many cases the update was shipped automatically, giving Cozy Bear remote access to any of the targets. They stayed hidden for months within the target networks, exfiltrating any data they found useful.</p>
<p>Targets for software supply chain attacks are much greater than for hardware. Since it&rsquo;s much easier to inject malware in software than it is to compromise hardware, the scope is much wider. All businesses are targets for software supply chain attacks, and therefore it must be included in any threat model.</p>
<p>The mitigation to ensure a malicious actor has not tampered with a software update is to check the signatures of the update binaries. But for attacks where the supplier itself has been compromised, there&rsquo;s not many good preventative security controls. Stopping a compromised software vendor comes down to detection and response. This is where EDR plays a vital role, and why the Crowdstrike issue was peak irony.</p>
<h2 id="5-compromised-software-libraries">5. Compromised software libraries</h2>
<p>I split this one away from software suppliers because libraries are imported in to your organisation&rsquo;s own code, rather than downloaded as a separate product. This is an important difference, because libraries don&rsquo;t have automatic updates. Software engineers usually pick a version of a third party library that works, and then stick with it until something breaks. This can, unfortunately, cause old and vulnerable versions to persist in your own products. It&rsquo;s also easy for a malicious actor to slip some code in to open-source products in particular.</p>
<p>The best recent example of this is the Log4Shell issue in 2021, where a critical vulnerability had been shipping in the popular Log4j logging framework since 2013. Anyone running Log4j was vulnerable to remote code execution for 8 years! That included most of the cloud suppliers and other enterprise networks.</p>
<p>The mitigation for this type of vulnerability is to use a dependency checker like OWASP&rsquo;s Dependency-Check or an equivalent commercial product. You could also run DAST tools to scan for any publicly disclosed vulnerabilities that might be accessible on listening ports or have some other exposure on the local machine.</p>
<h2 id="6-compromised-third-party-employees">6. Compromised third-party employees</h2>
<p>I&rsquo;ve done my fair share of contracts as a hired gun cyber security consultant in London, and I can say from experience that my background was almost never checked by the hiring company. After a scan of my CV, a single interview, and my signature on an NDA, I was given root access to many companys&rsquo; most critical systems.</p>
<p>Contractors fill an important role as a supplier of services, where expertise is required but only for a specific project of time period. Many contractors need access to sensitive assets such as source code, network infrastructure, and physical spaces.</p>
<p>The mitigation for malicious contractors is the same as for your internal employees. Vet them! Background checks and reference checks are a good start, along with providing them with your company laptop rather than letting them use their own.</p>
<h1 id="summary-of-best-practices">Summary of best practices</h1>
<ul>
<li>Threat model all systems at a business level and a technical level</li>
<li>Install detection and response tools at the endpoint and in the browser</li>
<li>Constantly monitor your external and internal attack surface</li>
<li>Check if saas apps are signed up to a bug bounty program</li>
<li>If you&rsquo;re in government, check that hardware products have passed the Common Criteria</li>
<li>The more paranoid amongst us could crack open hardware and take a look with a logic analyser</li>
<li>Check the signatures for software binaries after download</li>
<li>Deploy a dependency checker</li>
<li>Consistently run SAST and DAST scans against your code and app</li>
<li>Security code review</li>
<li>Vet your contractors and supply them with a company laptop</li>
</ul>

</content>
<p>
  
  <a href="http://localhost:1313/blog/supply-chain/">#Supply Chain</a>
  
</p>

  </main>
  <footer>Made with <a href="https://github.com/janraasch/hugo-bearblog/">Hugo ʕ•ᴥ•ʔ Bear</a>
</footer>

    
</body>

</html>
